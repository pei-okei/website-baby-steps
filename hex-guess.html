<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>[beta]peisite</title>

    <meta name="author" content="Pei-Jun H.">
    <meta name="keywords" content="hex code guessing, Pei-Jun">
    <meta name="description" content="Pei-Jun's website experimentation!">

    <link rel="stylesheet" href="styles.css">

    <link rel="icon" type="gif" href="img/spinning-CD.gif">
</head>
<body>

    <!--main menu-->
    <div id="mainmenu" 
    style="margin:auto;width: 95%; text-align: center; padding:10px;
    border:4px dotted #e444c3; background-color: #b9bee7; color:#3456ff;">  
        <p style="display:inline-block;font-size:24px;color:#55b000;font-family:Helvetica;font-weight:bold;">
            <img src="img/rotating-smiley.gif" style="height:20px;">
            menu
            <img src="img/spinning-CD.gif" style="height:20px;">
        </p>
        <br>
        <a href="index.html" class="nav">home</a>
            &nbsp; &#9733 &nbsp;
        <a href="hex-guess.html" class="nav">hex guess</a>
            &nbsp; &#9733 &nbsp;
        <a href="about.html" class="nav">about</a>
    </div>




    <!-- Developping my hex guess game below-->
    <h2> hex guess </h2>


    <p> Guess the hexcode of the color of the box. Your guess will appear below. </p>
    <input type="text" id="hexcode-text-input" value="#">

    <button onclick="makeGuess()">guess</button>

    <p id="distance-to-hexcode"> Distance = &infin; </p>


    <div id="hexcode-target-box" class="center-box" style="margin:20px;border-radius:25px;padding:50px">
        <p id="hexcode-guess-display" style="font-size:64px; font-family:Helvetica; font-weight: 800;">
            guess
        </p>
    </div>


    <button onclick="revealHideAnswer()">reveal/hide answer</button>
    <button onclick="newRandomHex()">play again</button>
    <p id="answer-hexcode" style="font-family:monospace;font-weight:bold;font-size:20px;"> <br> </p>


    <script>
        const hexadecimal_digits = ["0", "1", "2", "3", "4", "5", "6","7", "8", "9", "A", "B", "C", "D", "E", "F"];
        
        function randomHexDigit() {
            let random_index = Math.floor(Math.random() * 16);
            return hexadecimal_digits[random_index];
        } 

        function randomHexcode() {
            let hexcode = "#";
            for (let i = 0; i < 6; i++) {
                hexcode += randomHexDigit();
            }

            let shade_val = hexcode.replace("#","");
            shade_val = parseInt("0x" + shade_val[0] + shade_val[1]) + parseInt("0x" + shade_val[2] + shade_val[3]) + parseInt("0x" + shade_val[4] + shade_val[5]);

            let init_text_color = "" 
            if (shade_val >= 382) {
                init_text_color = "#000000";
            } else {
                init_text_color = "#FFFFFF";
            }

            document.getElementById("hexcode-guess-display").style.color = init_text_color;
            document.getElementById("hexcode-target-box").style.background = hexcode;
            // document.body.style.backgroundColor = hexcode;

            return hexcode;
        }
        
        let target_hexcode = randomHexcode();

        let show_answer = true;

        function revealHideAnswer() {
            if (show_answer) {
                document.getElementById("answer-hexcode").innerHTML = target_hexcode;
            } else {
                document.getElementById("answer-hexcode").innerHTML = "<br>";
            }
            show_answer = !(show_answer);
        }

        function makeGuess() {
            let guess = document.getElementById("hexcode-text-input").value;

            if (/^#[0-9A-F]{6}[0-9a-f]{0,2}$/i.test(guess) && guess.length == 7) {
                displayGuessColor(guess);
                hexcodeDistance(guess, target_hexcode);
            } else {
                document.getElementById("distance-to-hexcode").innerHTML = "Not a valid hexcode.";
            }
        }

        function displayGuessColor(hex) {
            document.getElementById("hexcode-guess-display").style.color = hex;
            document.getElementById("hexcode-guess-display").innerHTML = hex;
        }

        function hexcodeDistance(guess, target){
            let guess_str = guess.replace("#","");
            let target_str = target.replace("#","");
            let guess_RGB = ['0x'+guess_str[0]+guess_str[1], '0x'+guess_str[2]+guess_str[3], '0x'+guess_str[4]+guess_str[5]];
            let target_RGB = ['0x'+target_str[0]+target_str[1], '0x'+target_str[2]+target_str[3], '0x'+target_str[4]+target_str[5]];

            let hexcode_dist = 0.0;
            let color_diff = 0.0;

            for (let i = 0; i < 3; i++) {
                color_diff = (parseInt(guess_RGB[i]) - parseInt(target_RGB[i])).toFixed(2);
                hexcode_dist += color_diff * color_diff;
            }

            hexcode_dist = Math.sqrt(hexcode_dist).toFixed(2);

            let msg = "";
            if (hexcode_dist <= 10.0) {
                msg = " [hardly discernible!]";
            } else if (hexcode_dist <= 25.0) {
                msg = " [so close!]";
            } else if (hexcode_dist <= 50.0) {
                msg = " [close...]";
            } else {
                msg = " [not quite... keep trying!]";
            }
            
            document.getElementById("distance-to-hexcode").innerHTML = 'Distance = ' + hexcode_dist + msg;
        }

        function newRandomHex() {
            document.getElementById("answer-hexcode").innerHTML = "<br>";
            document.getElementById("distance-to-hexcode").innerHTML = "Distance = &infin;";
            document.getElementById("hexcode-guess-display").innerHTML = "guess";
            show_answer = true;
            target_hexcode = randomHexcode();
        }
    </script>
</body>
</html>